require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var rhy=require("./rhythmic"),pipe_symbol="\\|",pipe_expression=rhy.optional(rhy.capture(pipe_symbol+rhy.greedy(".*"))),quote_char="[`\"']",opening_quote_not_pipe=rhy.capture(rhy.negative_assertion(pipe_symbol)+rhy.optional(quote_char)),target=rhy.capture(rhy.greedy(rhy.one_or_more("."))),closing_quote=rhy.back_reference(1),target_expression=rhy.optional(rhy.nonCapturingGroup(opening_quote_not_pipe+target+closing_quote)),pattern=rhy.anchored(rhy.zero_or_more(" ")+target_expression+rhy.zero_or_more(" ")+pipe_expression+rhy.zero_or_more(" ")),matcher=new RegExp(pattern);module.exports=function(e){var r=matcher.exec(e);return null==r?null:{tag:r[0],quote:r[1]||"",token:r[2]||"",pipes:r[3]||""}};

},{"./rhythmic":5}],2:[function(require,module,exports){
"use strict";var rhy=require("./rhythmic"),anything_but_pipe_or_quote="[^\\|'\"`]*",params=function(r){return rhy.capture(rhy.zero_or_more(rhy.nonCapturingGroup(anything_but_pipe_or_quote+rhy.optional(rhy.quoted(".*?",r)))))},parenthetical_params=rhy.nonCapturingGroup(rhy.parenthetical(params(2))),comma_params=rhy.nonCapturingGroup(","+params(5)),pipe_params=rhy.choice_of(parenthetical_params,comma_params),pipe_expression=rhy.capture(rhy.identifier())+rhy.optional_whitespace()+rhy.optional(rhy.nonCapturingGroup(pipe_params)),pipe_symbol="\\|",pattern=rhy.nonCapturingGroup(pipe_symbol+rhy.optional_whitespace()+pipe_expression+rhy.optional_whitespace());module.exports=function(r){for(var p=new RegExp(pattern,"g"),e=p.exec(r),a=[];null!=e;)a.push({pipe:e[1],args:(e[2]||e[4]||"").trim()}),e=p.exec(r);return a};

},{"./rhythmic":5}],3:[function(require,module,exports){
"use strict";var pipe_matcher=require("./pipeParser");module.exports=function(r,e,p){if(""==e)return r;for(var i=pipe_matcher(e),t=0;t<i.length;t++){var a=i[t],n=p.pipes[a.pipe];if(n)try{r=n.apply(p,[r].concat(a.args.split(",").map(function(r){return r.trim()})))}catch(r){p.pipeExecutionError(r,a.pipe,a.args)}else p.pipeNotFound(a.pipe,a.args)}return r};

},{"./pipeParser":2}],4:[function(require,module,exports){
"use strict";module.exports=function(r,t){function n(r){return g(String(r))}function e(t){if("boolean"==typeof t)return t;if(t instanceof Boolean)return t.valueOf();if(r.isString(t)){if("true"===t.toLowerCase())return!0;if("false"===t.toLowerCase())return!1}throw new Error("Value could not be parsed as boolean - "+t)}function u(t){return r.parseInt(t)}function o(t){return r.toNumber(t)}function i(r){return JSON.stringify(r,null,2)}function a(r){return JSON.parse(r)}function s(r){return null===r}function c(t){return r.isNil(t)||!r.isString(t)||""==t.trim()}function f(r){return String(r).toUpperCase()}function m(r){return String(r).toLowerCase()}function d(r){return r=String(r).split('"').join('"'),r.indexOf(",")>=0&&(r='"'+r+'"'),r}function l(t,n,e){return t.substr(r.toNumber(n),r.toNumber(e))}function b(t,n,e){return t.substring(r.toNumber(n),r.toNumber(e))}function p(r,t,n){var e=B(t).exec(r);return n?e[parseInt(n)]:e}function N(r,t,n){return r.replace(B(t),n)}function g(r,t){return(r||t||"").toString().trim()}function w(t,n){return n=r.isNil(n)||""==n?",":/^(['"])?(.+?)\1$/.exec(n)[2],t.join(n||",")}function _(r,t){return String(r).split(t)}function y(t,n){return r.isUndefined(t)?n:t}function v(r){return!e(r)}function S(t,n,e,u){if(c(n)){r.isNil(e)&&(e=n,n=0);var o=r.parseInt(n);if(r.isNaN(o))throw new Error("Unable to parse value for min as integer: '"+n+"'");var i=r.parseInt(e);if(r.isNaN(i))throw new Error("Unable to parse value for max as integer: '"+e+"'");var a=!("true"==u);return r.random(o,i,a)}if(r.isString(t)){var s=/^\s*(?:(\d+)\s*-\s*)?(\d+)\s*$/,f=s.exec(g(t));if(f)return n=r.parseInt(f[1]),e=r.parseInt(f[2]),r.random(n,e);throw new Error("Could not parse value for format specifier, random - "+t)}return r.isInteger(t)?r.random(t):r.sample(t)}function C(t,n){return r.isArray(t)?r.reduce(t,function(t,n){return r.toNumber(t)+r.toNumber(n)},0):r.toNumber(t)+r.toNumber(n)}function I(t,n){return r.isArray(t)?r.reduce(t,function(t,n){return r.toNumber(t)-r.toNumber(n)},0):r.toNumber(t)-r.toNumber(n)}function h(t,n){return r.isArray(t)?r.reduce(t,function(t,n){return r.toNumber(t)*r.toNumber(n)},0):r.toNumber(t)*r.toNumber(n)}function x(t,n){return r.isArray(t)?r.reduce(t,function(t,n){return r.toNumber(t)/r.toNumber(n)},0):r.toNumber(t)/r.toNumber(n)}function U(t){if(!r.isArray(t))throw new Error("Value must be an array");return r.reduce(t,function(t,n){return r.toNumber(t)+r.toNumber(n)},0)/t.length}function E(r,t){return T(t)()}function j(r,t){return t=g(t),O(E(r,t))}function O(r,t){return z(r,"day")}function A(r,t,n){return n=g(n),t=g(t),T(n)(r,t)}function R(r,t,n){if(n=g(n),t=g(t),r=q(r,n),!r.isValid())throw new Error("Could not convert object to date - "+r.toString());return c(n)||(r=r.tz(n)),r.format(t)}function D(r,t){return t=g(t),A(r,t,"UTC")}function L(r,t){return t=g(t),R(r,t,"UTC")}function V(r,t,n){return n=g(n),q(r).clone().add(parseInt(t),n)}function $(t,n,e){return V(t,r.toNumber(n)*-1,e)}function z(r,t){return q(r).clone().startOf((t||"day").trim())}function J(r,t){return q(r).clone().endOf((t||"day").trim())}function T(n){return c(n)?t:r.partialRight(t.tz,g(n))}function q(t,n){return r.isNil(t)&&(t=new Date),t._isAMomentObject?t:(t instanceof Date||(r.isString(t)&&(t=g(t)),t=""==t?new Date:new Date(t)),T(n)(t))}function B(r){var t=/^\/(.+?)\/([igmy]*)$/.exec(r);return t?new RegExp(t[1],t[2]):new RegExp(r)}return{string:n,boolean:e,integer:u,number:o,json:i,json_parse:a,is_null:s,is_empty:c,upcase:f,toUpperCase:f,downcase:m,toLowerCase:m,csv_safe:d,substr:l,substring:b,urlencode:encodeURIComponent,urldecode:decodeURIComponent,match:p,replace:N,trim:g,join:w,split:_,optional:y,not:v,random:S,add:C,plus:C,sum:C,subtract:I,minus:I,difference:I,multiplied_by:h,product:h,times:h,divided_by:x,quotient:x,average:U,now:E,date_now:E,today:j,day:O,date_parse:A,parse_date:A,date_format:R,format_date:R,utc_parse:D,parse_utc:D,utc_format:L,format_utc:L,date_add:V,date_subtract:$,start_of:z,end_of:J}};

},{}],5:[function(require,module,exports){
"use strict";function quoted(e,r){return nonCapturingGroup(capture("['\"`]")+e+back_reference(r))}function optional_whitespace(){return zero_or_more("\\s")}function identifier(){return one_or_more("\\w")}function capture(e){return"("+e+")"}function nonCapturingGroup(e){return"(?:"+e+")"}function optional(e){return e+"?"}function greedy(e){return e+"?"}function parenthetical(e){return"\\("+e+"\\)"}function choice_of(){return Array.from(arguments).join("|")}function one_or_more(e){return e+"+"}function zero_or_more(e){return e+"*"}function combine(){return Array.from(arguments).join("")}function any_character_but(e){return"[^"+e+"]"}function anchored(e){return"^"+e+"$"}function negative_assertion(e){return"(?!"+e+")"}function back_reference(e){return"\\"+e}module.exports={anchored:anchored,any_character_but:any_character_but,back_reference:back_reference,capture:capture,choice_of:choice_of,combine:combine,greedy:greedy,identifier:identifier,negative_assertion:negative_assertion,nonCapturingGroup:nonCapturingGroup,one_or_more:one_or_more,optional:optional,parenthetical:parenthetical,quoted:quoted,optional_whitespace:optional_whitespace,zero_or_more:zero_or_more};

},{}],"calfinated":[function(require,module,exports){
"use strict";function try_require(e,t){if(e)return e;if("undefined"==typeof require)throw new Error("This module requires "+t);return require(t)}function calfinated(e,t){this._=try_require(e,"lodash"),this.moment=try_require(t,"moment"),this.pipes=require("./pipes")(this._,this.moment),this.delimiters=["<%","%>"]}var expressionParser=require("./expressionParser"),pipeProcessor=require("./pipeProcessor");module.exports=function(e,t){return new calfinated(e,t)},calfinated.prototype.add_pipes=function(e){this._.assign(this.pipes,e)},calfinated.prototype.process=function(e,t,r){var i=this;if(r=r||[],this._.isString(e)){var s=new RegExp(this.delimiters[0]+"!?(.+?)"+this.delimiters[1],"g"),n=s.exec(e);return null==n?e:n[0].length===e.length?this._objectExpression(n[1],t):this._stringTemplate(n,e,t,s)}return this._.isArray(e)?this._.map(e,function(e){return i.process(e,t,r)}):!this._.isPlainObject(e)||this._.isRegExp(e)||this._.isFunction(e)?e:this._.mapValues(e,function(e,s){return i._.includes(r,s)?e:i.process(e,t,r)})},calfinated.prototype.missingKeyError=function(e,t,r,i,s){throw new Error('MissingKeyError for non-optional key: "'+e+'"')},calfinated.prototype.pipeExecutionError=function(e,t,r){throw new Error("Error executing pipe: '"+t+"', args: '"+r+"', err: "+e)},calfinated.prototype.pipeNotFound=function(e){throw new Error("Pipe not found: '"+e+"'")},calfinated.prototype._replaceBackticks=function(e,t){var r=/`(.+?)`/g,i=r.exec(e);return null!=i&&(e=this._stringTemplate(i,e,t,r)),e},calfinated.prototype._objectExpression=function(e,t){e=this._replaceBackticks(e,t);var r=expressionParser(e);if(null==r)throw new Error("token contents did not match expected format");return pipeProcessor(this._getExpressionResult(r,t),r.pipes,this)},calfinated.prototype._stringTemplate=function(e,t,r,i){for(var s="",n=0;null!=e;){s+=t.substring(n,e.index);var o=this._replaceBackticks(e[1],r),p=expressionParser(o);if(null==p)throw new Error("token contents did not match expected format");s+=pipeProcessor(this._getExpressionResult(p,r),p.pipes,this),n=i.lastIndex,e=i.exec(t)}return s+=t.substring(n)},calfinated.prototype._getExpressionResult=function(e,t){return""===e.quote?""===e.token?null:(this._.has(t,e.token)||/^\|\s*optional(\W|$)/.test(e.pipes)||this.missingKeyError(e.token,e.tag,t,e.pipes,this),this._.get(t,e.token)):e.token};

},{"./expressionParser":1,"./pipeProcessor":3,"./pipes":4}]},{},["calfinated"]);
